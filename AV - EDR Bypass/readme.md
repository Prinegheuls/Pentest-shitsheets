# AV - EDR Bypass
This is a notebook of my quest of learning how to bypass defence. 

## Concept

- AV :
- EDR :

## Bypass methods

### Payload obsfucation

- Encoded payloads (Base, UUID, IPv4-v6, Morse, etc.)  
- Cyphered payload (XOR, AES, RC4, CEASAR, etc.)

### Direct/Indirect syscall

- Direct syscall:  https://redops.at/en/blog/direct-syscalls-a-journey-from-high-to-low
- Indirect syscall:  https://redops.at/en/blog/direct-syscalls-vs-indirect-syscalls

### API Unhooking 



## Executing a shellcode (locally/remotely)

For remotely, first enumerate processes:
- Take a "picture" of the running processes (CreateToolhelp32Snapshot())
- Get information on these processes (Process32First then Process32Next())

Then, make space for your shellcode, execute it and clean up your mess:

- Create memory space (VirtualAlloc() - VirtualAllocEx())
- Copy the shellcode in the memory space (memcpy() - WriteProcessMemory())
- Fill the initial shellcode's memory (memset())
- Allow execution of this memory space (VirtualProtect() - VirtualProtectEx())
- Execute the memory space (CreateThread() - CreateRemoteThread())
- Clean the memory space (HeapFree())

  

## How to install EDR to POC bypasses
### Elastic EDR
To test Elastic EDR, it is possible to install the following docker version and ask for a 30-day prenium trial:

- github : https://github.com/peasead/elastic-container

